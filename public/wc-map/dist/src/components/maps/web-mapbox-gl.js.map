{"version":3,"file":"web-mapbox-gl.js","sources":["../../../../src/components/maps/web-mapbox-gl.js"],"sourcesContent":["import { html } from 'lit';\r\n\r\nimport { WebMap } from './web-map.js';\r\nimport { fetchText } from '../../utils/fetchdata.js';\r\n\r\nexport class WebMapboxGL extends WebMap {\r\n\r\n  render() {\r\n    return html`\r\n      <style>\r\n        ${WebMapboxGL._externalStyles}\r\n      </style>\r\n      <div id=\"map\"></div>\r\n    `;\r\n  }\r\n\r\n  static _externalStyles = '';\r\n\r\n  async connectedCallback() {\r\n    super.connectedCallback();\r\n    this.status = 'web-mapbox-gl connected to the DOM'\r\n    try {\r\n      // Fetch and apply the external CSS\r\n      if (!WebMapboxGL._externalStyles) {\r\n        this.status = 'web-mapbox-gl fetching external CSS'\r\n        fetchText('https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css').then((text) => {\r\n          WebMapboxGL._externalStyles = text;\r\n          this.status = 'web-mapbox-gl external CSS fetched'\r\n          this.requestUpdate();\r\n        });\r\n      } \r\n      // Inject the mapbox script\r\n      const script = document.createElement('script');\r\n      script.src = 'https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js';\r\n      this.status = 'injecting MapboxGL script';\r\n      script.onload = async () => {\r\n        this.status = 'MapboxGL script loaded'\r\n        try {\r\n          // Add the map\r\n          //const map = new window.L.Map(this.shadowRoot.getElementById('map')).setView([52.3522, 5.1], 5);\r\n          const map = new mapboxgl.Map({\r\n            container: this.shadowRoot.querySelector('#map'),\r\n            style: {\r\n              version: 8,\r\n              center: [5.1, 52.2522],\r\n              zoom: 4.0,\r\n              pitch: 0,\r\n              sources: {},\r\n              layers: []\r\n            }\r\n          });\r\n          // set the mapbox access token\r\n          mapboxgl.accessToken = WebMapboxGL._keys.mapbox;\r\n          map.on('load', () => {\r\n            this.status = 'web-mapbox-gl ready';\r\n            this.dispatchEvent(new CustomEvent('map-ready'));\r\n            console.log('web-mapbox-gl map-ready event dispatched')\r\n            map.addLayer({\r\n              id: 'world',\r\n              type: 'fill',\r\n              source: {\r\n                type: 'geojson',\r\n                data: './data/world.geo.json',\r\n                attribution: '<a href=\"https://www.naturalearthdata.com/\">Natural Earth</a>'\r\n              },\r\n              paint: {\r\n                'fill-color': '#bbcce4',\r\n                'fill-outline-color': '#3388ff'\r\n              }\r\n            })\r\n          });\r\n        } catch (error) {\r\n          this.status = error.message;\r\n        }\r\n      };\r\n      document.head.appendChild(script);\r\n    } catch (error) {\r\n      this.status = error.message;\r\n      console.error('web-mapbox-gl: ' + error.message)\r\n    }\r\n  }\r\n}\r\n\r\ncustomElements.define('web-mapbox-gl', WebMapboxGL);"],"names":["html"],"mappings":"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"}